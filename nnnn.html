<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>สำหรับเธอ</title>

<style>
html, body{
margin:0;
padding:0;
width:100%;
height:100%;
overflow:hidden;
background:#ffb6c1;
font-family:"Comic Sans MS", cursive;
touch-action:none;
}

/* ข้อความ */
.text{
position:absolute;
color:white;
font-size:30px;
opacity:0;
transform:scale(0.7);
transition: all 3s ease;
text-shadow:0 0 18px rgba(255,255,255,0.9);
z-index:9999;
}

/* ฟอง */
.float{
position:absolute;
width:60px;
height:60px;
border-radius:50%;
overflow:hidden;
box-shadow:
0 4px 12px rgba(0,0,0,0.25),
inset 0 0 10px rgba(255,255,255,0.5);
transition:all 14s linear;
z-index:1;
background:rgba(255,255,255,0.15);
backdrop-filter: blur(3px);
}

/* แสงสะท้อนฟอง */
.float::before{
content:"";
position:absolute;
top:6px;
left:14px;
width:18px;
height:18px;
background:rgba(255,255,255,0.7);
border-radius:50%;
filter:blur(3px);
}

/* รูป / วิดีโอ */
.float video,
.float img{
width:100%;
height:100%;
object-fit:cover;
border-radius:50%;
display:block;
}
</style>
</head>
<body>

<audio id="music" autoplay loop preload="auto">
<source src="https://files.catbox.moe/nzxwlu.mp4" type="audio/mp4">
</audio>

<div id="scene"></div>

<script>
const scene = document.getElementById("scene")
const music = document.getElementById("music")

music.playbackRate = 1.1

function startMusic(){
music.play().then(()=>{
startMessages()
}).catch(()=>{})
}

window.addEventListener("load",startMusic)
document.addEventListener("click",startMusic)
document.addEventListener("touchstart",startMusic)

/* ข้อความ */
const messages = [
"เธอยังจำได้มั้ย",
"เวลาที่เราอยู่ด้วยกัน",
"พี่โคตรมีความสุขเลย",
"พี่อยากบอกว่า",
"พี่รักหนูมากนะ"
]

const loopMessages = [
"คิดถึงนะ",
"อยากอยู่ด้วยกันนานๆ",
"ทุกช่วงเวลาสำคัญมาก",
"ขอบคุณที่อยู่ด้วยกัน",
"รักมากจริงๆ"
]

const videos = [
"https://files.catbox.moe/58rz1z.mp4",
"https://files.catbox.moe/ur56oh.mp4",
"https://files.catbox.moe/xuhtxi.mp4",
"https://files.catbox.moe/lv14ae.mp4",
"https://files.catbox.moe/5z1p2a.mp4"
]

const images = [
"https://files.catbox.moe/v9gd8n.jpg",
"https://files.catbox.moe/4pclvj.jpg",
"https://files.catbox.moe/ufaaa0.jpeg",
"https://files.catbox.moe/05uqen.jpg",
"https://files.catbox.moe/sda8fm.jpg"
]

let index = 0
let showingText = false

function startMessages(){
setTimeout(showMessages,1200)
}

function showMessages(){
if(showingText) return

if(index >= messages.length){
startFloating()
startLoopText()
return
}

showingText = true
createText(messages[index])
index++

setTimeout(()=>{
showingText = false
showMessages()
},4500)
}

function createText(message){
const text = document.createElement("div")
text.className = "text"
text.innerText = message

text.style.left = Math.random()*70 + "vw"
text.style.top = Math.random()*70 + "vh"

scene.appendChild(text)

setTimeout(()=>{
text.style.opacity = 1
text.style.transform = "scale(1)"
},100)

setTimeout(()=>{
text.style.opacity = 0
setTimeout(()=>text.remove(),2000)
},3500)
}

function startLoopText(){
setInterval(()=>{
if(showingText) return
showingText = true

const msg = loopMessages[Math.floor(Math.random()*loopMessages.length)]
createText(msg)

setTimeout(()=>{
showingText = false
},4500)

},5000)
}

/* ฟองออกจากขอบจอ */
function randomExit(){
const side = Math.floor(Math.random()*4)

if(side===0) return {x:-120, y:Math.random()*window.innerHeight}
if(side===1) return {x:window.innerWidth+120, y:Math.random()*window.innerHeight}
if(side===2) return {x:Math.random()*window.innerWidth, y:-120}
return {x:Math.random()*window.innerWidth, y:window.innerHeight+120}
}

/* สร้างฟอง */
function createFloat(type,src){
const box = document.createElement("div")
box.className="float"

let media

if(type==="video"){
media=document.createElement("video")
media.src=src
media.autoplay=true
media.loop=true
media.muted=true
media.playsInline=true
media.preload="auto"
media.onloadeddata=startMove
}else{
media=document.createElement("img")
media.src=src
media.onload=startMove
}

box.appendChild(media)

const start = randomExit()
box.style.left = start.x + "px"
box.style.top = start.y + "px"

function startMove(){
scene.appendChild(box)

const insideX = Math.random()*(window.innerWidth-60)
const insideY = Math.random()*(window.innerHeight-60)

setTimeout(()=>{
box.style.left = insideX + "px"
box.style.top = insideY + "px"
},100)

setTimeout(()=>{
const end = randomExit()
box.style.left = end.x + "px"
box.style.top = end.y + "px"
},9000)

setTimeout(()=>{
box.remove()
floatingCount--
},14000)
}
}

/* ระบบให้มี 10 ฟองตลอด */
let floatingCount = 0
const MIN_FLOAT = 10

function spawnRandom(){
const type = Math.random() > 0.5 ? "video" : "image"
floatingCount++
spawn(type)
}

function spawn(type){
if(type==="video"){
const src = videos[Math.floor(Math.random()*videos.length)]
createFloat("video",src)
}else{
const src = images[Math.floor(Math.random()*images.length)]
createFloat("image",src)
}
}

function startFloating(){

for(let i=0;i<MIN_FLOAT;i++){
spawnRandom()
}

setInterval(()=>{
if(floatingCount < MIN_FLOAT){
spawnRandom()
}
},600)

}
</script>

</body>
</html>
